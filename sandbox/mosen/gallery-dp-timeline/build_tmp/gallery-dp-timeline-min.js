YUI.add("gallery-dp-timeline",function(d){var c=d.Lang,b=d.Node,a=d.DataType;d.namespace("DP").Timeline=d.Base.create("gallery-dp-timeline",d.Widget,[],{initializer:function(){},destructor:function(){},renderUI:function(){this._renderHeadings();this._renderHeadingsDays();this._renderBackgroundContainer();this._renderEventContainer();this._renderEvents();this.get("contentBox").append(this._nodeDayContainer);this.get("contentBox").append(this._nodeEventContainer);},bindUI:function(){},syncUI:function(){var e=this.get("events");console.dir(e);},_renderHeadings:function(){var e=b.create(d.substitute(this.get("tplDayContainer"),{className:this.getClassName("day","container")}));this._nodeDayContainer=e;},_renderHeadingsDays:function(){var f=this.get("date"),e,h;for(h=0;h<this.get("length");h++){e=new Date(f.getTime());e.setDate(e.getDate()+h);var g=b.create(d.substitute(this.get("tplDay"),{className:this.getClassName("day"),labelClassName:this.getClassName("day","label"),label:a.Date.format(e,{format:"%a %e"})}));g.set("style.left",this.dateToOffset(e)+"px");g.set("style.width",this.get("dayWidth")+"px");this._nodeDayContainer.append(g);}},_renderEventContainer:function(){this._nodeEventContainer=b.create(d.substitute(this.get("tplEventContainer"),{className:this.getClassName("event","container")}));},_renderEvents:function(){var e=this.get("date");this.clearDateTime(e);d.Array.each(this.get("events"),function(f){if(f.start<e){}else{this._renderEvent(f);}},this);},_renderEvent:function(k){var i=b.create(d.substitute(this.get("tplEvent"),{className:this.getClassName("event"),titleClassName:this.getClassName("event","title"),title:k.summary})),g=this.rangeToDuration(k.start,k.finish),f=this.dateToOffset(k.start),m=this.get("dayWidth")*g,l=f+m,n=this._getFreeSlot(k,f),h=n*(this.get("eventHeight")),j=this.get("slots");k.slot=n;j[n]=l;i.set("style.left",f+"px");i.set("style.top",h+"px");i.set("style.width",m+"px");this._nodeEventContainer.append(i);},_renderBackgroundContainer:function(){var e=b.create(d.substitute(this.get("tplBackgroundContainer"),{className:this.getClassName("background")}));this.get("contentBox").append(e);},_renderBackgroundHighlights:function(){},dateToOffset:function(e){var h=1000*60*60*24,g=e.getTime()-this.get("date").getTime(),f=Math.floor(g/h);return f*this.get("dayWidth");},rangeToDuration:function(i,e){var h=1000*60*60*24,g=e.getTime()-i.getTime(),f=Math.ceil(g/h)+1;return f;},clearDateTime:function(e){e.setHours(0);e.setMinutes(0);e.setSeconds(0);e.setMilliseconds(0);return e;},_getFreeSlot:function(h,j){var g=this.get("slots");if(c.isNumber(h.slot)){return h.slot;}for(var f=0;f<g.length;f++){if(g[f]<=j){break;}else{}}return f;},_nodeDays:Array()},{NAME:"timeline",ATTRS:{tplDayContainer:{value:'<div class="{className}"></div>'},tplDay:{value:'<div class="{className}"><span class="{labelClassName}">{label}</span></div>'},tplEventContainer:{value:'<div class="{className}"></div>'},tplEvent:{value:'<div class="{className}"><span class="{titleClassName}">{title}</span></div>'},tplBackgroundContainer:{value:'<div class="{className}"></div>'},dayWidth:{value:100},eventHeight:{value:20},date:{value:Date()},length:{value:8},slots:{value:Array()},events:{value:Array(),setter:function(e){d.Array.each(e,function(f){if(c.isString(f.start)){f.start=a.Date.parse(f.start);}if(c.isString(f.finish)){f.finish=a.Date.parse(f.finish);}},this);}}},HTML_PARSER:{}});},"@VERSION@",{requires:["base","widget","substitute","node","datatype"]});