YUI.add("gallery-dp-table",function(g){g.namespace("DP").CellRenderers={date:function(i,j,h){var k=i[j];if(e.isDate(k)){h.set("innerHTML",g.DataType.Date.format(k,{format:"%x"}));}},niceDate:function(k,l,i){var n=k[l];if(e.isDate(n)){var j=new Date();j.setHours(0,0,0,0);var m=n-j,h=m/1000/60/60/24;if(h>=0&&h<=6){if(h<1){i.set("innerHTML","Today");}else{if(h<2){i.set("innerHTML","Tomorrow");}else{i.set("innerHTML",g.DataType.Date.format(n,{format:"%A"}));}}}else{if(h>-2&&h<0){i.set("innerHTML","Yesterday");}else{i.set("innerHTML",g.DataType.Date.format(n,{format:"%x"}));}}}},hash:function(h){return function(l,n,i){var k=h;var m=g.one(k),j=g.JSON.parse(m.get("innerHTML"));i.set("innerHTML",j[l[n]]);};},progress:function(){return function(n,p,l){var j=parseInt(n[p],0),q='<div class="yui3-dp-cellrenderer-progress-text">{text}</div>',h='<div class="yui3-dp-cellrenderer-progress" style="width: {width}%">{textnode}</div>',i='<div class="yui3-dp-cellrenderer-progress-wrap">{bar}</div>';var k=g.substitute(q,{text:j+"%"});var o=g.substitute(h,{width:j,textnode:k});var m=g.substitute(i,{bar:o});l.append(b.create(m));};}};var e=g.Lang,b=g.Node;g.namespace("DP").TableBody=g.Base.create("dp-table-body",g.Widget,[],{initializer:function(h){this._tbodyNode=this.get("contentBox");this.publish("success",{defaultFn:this._defResponseSuccessFn});this.publish("loading",{defaultFn:this._defLoadingFn});this._ioHandlers={complete:g.bind(this._handleResponse,this,"complete"),success:g.bind(this._handleResponse,this,"success"),failure:g.bind(this._handleResponse,this,"failure"),end:g.bind(this._handleResponse,this,"end")};},destructor:function(){this._tbodyNode.detach("click");this._tbodyNode.detach("mouseenter");this._tbodyNode.detach("mouseleave");this._tbodyNode=null;},renderUI:function(){this.load("");},bindUI:function(){this._tbodyNode.delegate("selectstart",function(h){h.preventDefault();},"tr",this);this.after("dataChange",this._afterDataChange);this.after("loadingChange",this._afterLoadingChange);this.after("queryParametersChange",this._afterQueryParametersChange);},syncUI:function(){},_ioHandlers:null,_tbodyNode:null,_renderTableRows:function(){var l=this.get("data"),k=this._tbodyNode,r;if(l.results.length>0){k.setContent("");for(var m=0;m<l.results.length;m++){r=(m%2)?"row":"row-alt";var n=g.substitute(this.ROW_TEMPLATE,{trClassName:this.getClassName(r)});var o=b.create(n);var t=this.get("cells");for(var q=0;q<t.length;q++){var s=t[q],p=s.field,h=s.width;var j=b.create(g.substitute(this.CELL_TEMPLATE,{tdClassName:this.getClassName("cell")}));if(undefined===s.renderer){j.setContent(l.results[m][p]);}else{s.renderer(l.results[m],p,j);}j.set("width",h);o.append(j);}k.append(o);}}else{k.setContent("");k.append(b.create(g.substitute(this.ZEROROWS_TEMPLATE,{colspan:this.get("cells").length,message:this.get("strings.zerorows")})));}},load:function(h){var i=this.get("dataSource");i.sendRequest({request:h,callback:this._ioHandlers});this.fire("loading",{id:this._io,request:h});},_handleResponse:function(h,i){this.fire(h,{id:this._io,response:i.response});this._io=null;},handleParameterChange:function(h){var i=this.get("queryParameters");i[h.type]=h.parameters;this.set("queryParameters",i);},_defResponseSuccessFn:function(h){this.set("data",h.response);this.set("loading",false);},_defLoadingFn:function(h){this.set("loading",true);},_afterDataChange:function(h){this._renderTableRows();},_afterLoadingChange:function(h){var i=this.get("loading");if(i){}else{}},_afterQueryParametersChange:function(){var l=this.get("queryParameters"),j=Array(),k,i;for(k in l){for(i in l[k]){if(l[k][i].length>0){j.push(i+"="+l[k][i]);}}}var h="?"+j.join("&");this.load(h);},CONTENT_TEMPLATE:null,ZEROROWS_TEMPLATE:'<tr><td colspan="{colspan}">{message}</td></tr>',ROW_TEMPLATE:'<tr class="{trClassName}"></tr>',CELL_TEMPLATE:'<td class="{tdClassName}"></td>'},{NAME:"dp-table-body",ATTRS:{strings:{value:{loading:"Loading...",zerorows:"No results available"}},cells:{value:Array()},dataSource:{value:null},data:{value:null},loading:{value:false,validator:e.isBoolean},queryParameters:{value:Array(),validator:e.isArray}},HTML_PARSER:{tbodyNode:".yui3-dp-table-body"}});var d="asc",f="desc",a="sortKey",c="sortDirection";g.namespace("DP").TableHeaders=g.Base.create("dp-table-headers",g.Widget,[],{initializer:function(h){this.publish("sort",{defaultFn:this._defSortFn});this.publish("columnover",{defaultFn:this._uiSetColumnOver});this.publish("columnout",{defaultFn:this._uiSetColumnOut});this.publish("queryUpdate",{defaultFn:this._defQueryUpdateFn});},destructor:function(){this._theadNode.detach("click");this._theadNode.detach("mouseenter");this._theadNode.detach("mouseleave");this._theadNode=null;},renderUI:function(){this._renderTableColumns();},bindUI:function(){var h=this.get("theadNode");this.after("columnsChange",this._afterColumnsChange);h.delegate("selectstart",function(i){i.preventDefault();},"th",this);h.delegate("click",function(i){this.fire("sort",{headerTarget:i.currentTarget});},"th",this);h.delegate("mouseenter",function(i){this.fire("columnover",{headerTarget:i.currentTarget});},"th",this);h.delegate("mouseleave",function(i){this.fire("columnout",{headerTarget:i.currentTarget});},"th",this);},syncUI:function(){},_renderTableColumns:function(){var i=this.get("columns");for(var k=0;k<i.length;k++){var j=i[k].node;var h=g.Node.create(g.substitute(this.COLUMN_LABEL_TEMPLATE,{className:this.getClassName("label"),label:j.get("innerHTML")}));j.setContent("");j.append(h);i[k].sortNode=b.create(g.substitute(this.COLUMN_SORT_INDICATOR_TEMPLATE,{className:this.getClassName("sort")}));if(k===0){i[k].node.addClass(this.getClassName("column","leftcorner"));}else{if(k==(i.length-1)){i[k].node.addClass(this.getClassName("column","rightcorner"));}}j.append(i[k].sortNode);}},_defSortFn:function(h){this.sort(h.headerTarget);},_defQueryUpdateFn:function(h){},_uiSetColumnOver:function(i){var h=i.headerTarget;if(!h.hasClass(this.getClassName("column","over"))){h.addClass(this.getClassName("column","over"));
}},_uiSetColumnOut:function(i){var h=i.headerTarget;if(h.hasClass(this.getClassName("column","over"))){h.removeClass(this.getClassName("column","over"));}},sort:function(i,j){var h=this.get("columns");for(var k=0;k<h.length;k++){if(h[k].node==i){switch(h[k].sort){case d:h[k].sort=(undefined===j)?f:j;break;case f:h[k].sort=(undefined===j)?"":j;break;default:h[k].sort=(undefined===j)?d:j;}break;}}this.set("columns",h);},_afterColumnsChange:function(k){var j=this.get("columns"),h=Array();for(var l=0;l<j.length;l++){var i=j[l];h["sort["+i.key+"]"]=i.sort;switch(i.sort){case d:if(i.sortNode.hasClass(this.getClassName("sort","desc"))){i.sortNode.removeClass(this.getClassName("sort","desc"));}i.sortNode.addClass(this.getClassName("sort","asc"));break;case f:if(i.sortNode.hasClass(this.getClassName("sort","asc"))){i.sortNode.removeClass(this.getClassName("sort","asc"));}i.sortNode.addClass(this.getClassName("sort","desc"));break;default:if(i.sortNode.hasClass(this.getClassName("sort","desc"))){i.sortNode.removeClass(this.getClassName("sort","desc"));}if(i.sortNode.hasClass(this.getClassName("sort","asc"))){i.sortNode.removeClass(this.getClassName("sort","asc"));}}}this.fire("queryUpdate",{parameters:h});},COLUMN_SORT_INDICATOR_TEMPLATE:'<div class="{className}">&nbsp;</div>',COLUMN_LABEL_TEMPLATE:'<span class="{className}">{label}</span>',CONTENT_TEMPLATE:null},{NAME:"dp-table-headers",ATTRS:{theadNode:{value:null},columnsNode:{value:null},columns:{value:Array()}},HTML_PARSER:{theadNode:"thead.yui3-gallery-dp-table-headers",columnsNode:"tr.yui3-gallery-dp-table-headers-columns",columns:function(j){var i=Array(),h=j.one(".yui3-dp-table-headers-columns").all(".yui3-dp-table-headers-column");h.each(function(k){i.push({title:k.get("innerHTML"),width:k.get("width"),key:k.getAttribute(a),sort:k.getAttribute(c),node:k});},this);return i;}}});},"@VERSION@",{requires:["substitute","json-parse","node","widget","datatype","dataschema","datasource","node-pluginhost"]});YUI.add("gallery-dp-table",function(a){},"@VERSION@",{skinnable:false,use:["dp-table"]});